Reading lines...
Read 20910 sentence pairs
Trimmed to 20910 sentence pairs
Counting words...
Counted words:
scan_in 15
scan_out 8
GPU unavailable, training with CPU
Initialized model GRU
Training SCAN model GRU on split 'mcd' for 150000 iterations on device cpu, intermediate rep? False, tag 4
Reading lines...
Read 8365 sentence pairs
Trimmed to 8365 sentence pairs
Counting words...
Counted words:
scan_in 15
scan_out 8
Loaded data from scan/SCAN-master/mcd_train.txt
8365 examples. Sample pair: ['walk left twice and run around right', 'I_TURN_LEFT I_WALK I_TURN_LEFT I_WALK I_TURN_RIGHT I_RUN I_TURN_RIGHT I_RUN I_TURN_RIGHT I_RUN I_TURN_RIGHT I_RUN']
Reading lines...
Read 1045 sentence pairs
Trimmed to 1045 sentence pairs
Counting words...
Counted words:
scan_in 15
scan_out 8
Loaded data from scan/SCAN-master/mcd_test.txt
1045 examples. Sample pair: ['look around left twice after turn opposite right thrice', 'I_TURN_RIGHT I_TURN_RIGHT I_TURN_RIGHT I_TURN_RIGHT I_TURN_RIGHT I_TURN_RIGHT I_TURN_LEFT I_LOOK I_TURN_LEFT I_LOOK I_TURN_LEFT I_LOOK I_TURN_LEFT I_LOOK I_TURN_LEFT I_LOOK I_TURN_LEFT I_LOOK I_TURN_LEFT I_LOOK I_TURN_LEFT I_LOOK']
Starting training: 150000 iterations
Hits 0/100 test samples
Duration (Remaining): 0m 47s (- 118m 13s) Iters: (1000 0%) Loss avg: 1.2386
Hits 0/100 test samples
Duration (Remaining): 1m 25s (- 105m 11s) Iters: (2000 1%) Loss avg: 0.8782
Hits 4/100 test samples
Duration (Remaining): 2m 3s (- 100m 40s) Iters: (3000 2%) Loss avg: 0.7436
Hits 4/100 test samples
Duration (Remaining): 2m 44s (- 99m 54s) Iters: (4000 2%) Loss avg: 0.6160
Hits 11/100 test samples
Duration (Remaining): 3m 31s (- 102m 24s) Iters: (5000 3%) Loss avg: 0.5568
Hits 13/100 test samples
Duration (Remaining): 4m 25s (- 106m 14s) Iters: (6000 4%) Loss avg: 0.4686
Hits 27/100 test samples
Duration (Remaining): 5m 7s (- 104m 46s) Iters: (7000 4%) Loss avg: 0.4248
Hits 33/100 test samples
Duration (Remaining): 5m 49s (- 103m 15s) Iters: (8000 5%) Loss avg: 0.3598
Hits 34/100 test samples
Duration (Remaining): 6m 27s (- 101m 5s) Iters: (9000 6%) Loss avg: 0.3284
Hits 45/100 test samples
Duration (Remaining): 7m 3s (- 98m 47s) Iters: (10000 6%) Loss avg: 0.3268
Hits 41/100 test samples
Duration (Remaining): 7m 41s (- 97m 6s) Iters: (11000 7%) Loss avg: 0.3049
Hits 39/100 test samples
Duration (Remaining): 8m 19s (- 95m 40s) Iters: (12000 8%) Loss avg: 0.2513
Hits 38/100 test samples
Duration (Remaining): 9m 7s (- 96m 14s) Iters: (13000 8%) Loss avg: 0.2478
Hits 51/100 test samples
Duration (Remaining): 9m 54s (- 96m 12s) Iters: (14000 9%) Loss avg: 0.2215
Hits 43/100 test samples
Duration (Remaining): 10m 31s (- 94m 40s) Iters: (15000 10%) Loss avg: 0.1841
Hits 56/100 test samples
Duration (Remaining): 11m 9s (- 93m 29s) Iters: (16000 10%) Loss avg: 0.2121
Hits 75/100 test samples
Duration (Remaining): 11m 46s (- 92m 8s) Iters: (17000 11%) Loss avg: 0.1949
Hits 54/100 test samples
Duration (Remaining): 12m 25s (- 91m 6s) Iters: (18000 12%) Loss avg: 0.1484
Hits 59/100 test samples
Duration (Remaining): 13m 2s (- 89m 55s) Iters: (19000 12%) Loss avg: 0.1746
Hits 69/100 test samples
Duration (Remaining): 13m 40s (- 88m 53s) Iters: (20000 13%) Loss avg: 0.1674
Hits 72/100 test samples
Duration (Remaining): 14m 18s (- 87m 51s) Iters: (21000 14%) Loss avg: 0.1468
Hits 65/100 test samples
Duration (Remaining): 14m 55s (- 86m 48s) Iters: (22000 14%) Loss avg: 0.1366
Hits 71/100 test samples
Duration (Remaining): 15m 37s (- 86m 19s) Iters: (23000 15%) Loss avg: 0.1467
Hits 73/100 test samples
Duration (Remaining): 16m 32s (- 86m 51s) Iters: (24000 16%) Loss avg: 0.1228
Hits 75/100 test samples
Duration (Remaining): 17m 15s (- 86m 17s) Iters: (25000 16%) Loss avg: 0.1291
Hits 74/100 test samples
Duration (Remaining): 18m 2s (- 86m 3s) Iters: (26000 17%) Loss avg: 0.1174
Hits 63/100 test samples
Duration (Remaining): 18m 45s (- 85m 29s) Iters: (27000 18%) Loss avg: 0.1615
Hits 76/100 test samples
Duration (Remaining): 19m 29s (- 84m 56s) Iters: (28000 18%) Loss avg: 0.0935
Hits 67/100 test samples
Duration (Remaining): 20m 6s (- 83m 53s) Iters: (29000 19%) Loss avg: 0.0932
Hits 64/100 test samples
Duration (Remaining): 20m 45s (- 83m 0s) Iters: (30000 20%) Loss avg: 0.0868
Hits 67/100 test samples
Duration (Remaining): 21m 38s (- 83m 3s) Iters: (31000 20%) Loss avg: 0.0922
Hits 72/100 test samples
Duration (Remaining): 22m 20s (- 82m 22s) Iters: (32000 21%) Loss avg: 0.0816
Hits 74/100 test samples
Duration (Remaining): 22m 59s (- 81m 30s) Iters: (33000 22%) Loss avg: 0.0830
Hits 70/100 test samples
Duration (Remaining): 23m 35s (- 80m 30s) Iters: (34000 22%) Loss avg: 0.0700
Hits 63/100 test samples
Duration (Remaining): 24m 11s (- 79m 29s) Iters: (35000 23%) Loss avg: 0.0668
Hits 78/100 test samples
Duration (Remaining): 24m 49s (- 78m 35s) Iters: (36000 24%) Loss avg: 0.0810
Hits 77/100 test samples
Duration (Remaining): 25m 26s (- 77m 42s) Iters: (37000 24%) Loss avg: 0.0944
Hits 75/100 test samples
Duration (Remaining): 26m 6s (- 76m 56s) Iters: (38000 25%) Loss avg: 0.0584
Hits 72/100 test samples
Duration (Remaining): 27m 0s (- 76m 53s) Iters: (39000 26%) Loss avg: 0.0808
Hits 73/100 test samples
Duration (Remaining): 27m 38s (- 76m 0s) Iters: (40000 26%) Loss avg: 0.0558
Hits 66/100 test samples
Duration (Remaining): 28m 57s (- 76m 59s) Iters: (41000 27%) Loss avg: 0.0680
Hits 79/100 test samples
Duration (Remaining): 30m 0s (- 77m 10s) Iters: (42000 28%) Loss avg: 0.0696
Hits 84/100 test samples
Duration (Remaining): 31m 0s (- 77m 10s) Iters: (43000 28%) Loss avg: 0.0696
Hits 86/100 test samples
Duration (Remaining): 31m 52s (- 76m 47s) Iters: (44000 29%) Loss avg: 0.0524
Hits 85/100 test samples
Duration (Remaining): 32m 52s (- 76m 41s) Iters: (45000 30%) Loss avg: 0.0638
Hits 87/100 test samples
Duration (Remaining): 33m 31s (- 75m 48s) Iters: (46000 30%) Loss avg: 0.0396
Hits 75/100 test samples
Duration (Remaining): 34m 11s (- 74m 56s) Iters: (47000 31%) Loss avg: 0.0486
Hits 82/100 test samples
Duration (Remaining): 34m 49s (- 73m 59s) Iters: (48000 32%) Loss avg: 0.0528
Hits 87/100 test samples
Duration (Remaining): 35m 23s (- 72m 58s) Iters: (49000 32%) Loss avg: 0.0506
Hits 86/100 test samples
Duration (Remaining): 36m 6s (- 72m 13s) Iters: (50000 33%) Loss avg: 0.0604
Hits 83/100 test samples
Duration (Remaining): 36m 42s (- 71m 14s) Iters: (51000 34%) Loss avg: 0.0610
Hits 71/100 test samples
Duration (Remaining): 37m 17s (- 70m 16s) Iters: (52000 34%) Loss avg: 0.0755
Hits 74/100 test samples
Duration (Remaining): 37m 53s (- 69m 21s) Iters: (53000 35%) Loss avg: 0.0528
Hits 85/100 test samples
Duration (Remaining): 38m 36s (- 68m 38s) Iters: (54000 36%) Loss avg: 0.0615
Hits 91/100 test samples
Duration (Remaining): 39m 21s (- 67m 59s) Iters: (55000 36%) Loss avg: 0.0527
Hits 82/100 test samples
Duration (Remaining): 39m 56s (- 67m 3s) Iters: (56000 37%) Loss avg: 0.0575
Hits 87/100 test samples
Duration (Remaining): 40m 34s (- 66m 12s) Iters: (57000 38%) Loss avg: 0.0545
Hits 84/100 test samples
Duration (Remaining): 41m 10s (- 65m 19s) Iters: (58000 38%) Loss avg: 0.0476
Hits 76/100 test samples
Duration (Remaining): 41m 47s (- 64m 27s) Iters: (59000 39%) Loss avg: 0.0454
Hits 84/100 test samples
Duration (Remaining): 42m 26s (- 63m 40s) Iters: (60000 40%) Loss avg: 0.0544
Hits 77/100 test samples
Duration (Remaining): 43m 5s (- 62m 51s) Iters: (61000 40%) Loss avg: 0.0586
Hits 84/100 test samples
Duration (Remaining): 43m 43s (- 62m 4s) Iters: (62000 41%) Loss avg: 0.0377
Hits 81/100 test samples
Duration (Remaining): 44m 23s (- 61m 18s) Iters: (63000 42%) Loss avg: 0.0363
Hits 87/100 test samples
Duration (Remaining): 45m 7s (- 60m 38s) Iters: (64000 42%) Loss avg: 0.0353
Hits 90/100 test samples
Duration (Remaining): 45m 49s (- 59m 54s) Iters: (65000 43%) Loss avg: 0.0409
Hits 86/100 test samples
Duration (Remaining): 46m 24s (- 59m 4s) Iters: (66000 44%) Loss avg: 0.0374
Hits 86/100 test samples
Duration (Remaining): 47m 0s (- 58m 14s) Iters: (67000 44%) Loss avg: 0.0392
Hits 85/100 test samples
Duration (Remaining): 47m 38s (- 57m 26s) Iters: (68000 45%) Loss avg: 0.0435
Hits 90/100 test samples
Duration (Remaining): 48m 15s (- 56m 39s) Iters: (69000 46%) Loss avg: 0.0358
Hits 89/100 test samples
Duration (Remaining): 48m 53s (- 55m 52s) Iters: (70000 46%) Loss avg: 0.0319
Hits 83/100 test samples
Duration (Remaining): 49m 36s (- 55m 12s) Iters: (71000 47%) Loss avg: 0.0406
Hits 88/100 test samples
Duration (Remaining): 50m 16s (- 54m 27s) Iters: (72000 48%) Loss avg: 0.0466
Hits 89/100 test samples
Duration (Remaining): 50m 55s (- 53m 42s) Iters: (73000 48%) Loss avg: 0.0419
Hits 90/100 test samples
Duration (Remaining): 51m 35s (- 52m 59s) Iters: (74000 49%) Loss avg: 0.0298
Hits 91/100 test samples
Duration (Remaining): 52m 20s (- 52m 20s) Iters: (75000 50%) Loss avg: 0.0321
Hits 90/100 test samples
Duration (Remaining): 52m 57s (- 51m 33s) Iters: (76000 50%) Loss avg: 0.0356
Hits 89/100 test samples
Duration (Remaining): 53m 37s (- 50m 50s) Iters: (77000 51%) Loss avg: 0.0256
Hits 92/100 test samples
Duration (Remaining): 54m 35s (- 50m 23s) Iters: (78000 52%) Loss avg: 0.0352
Hits 86/100 test samples
Duration (Remaining): 55m 21s (- 49m 45s) Iters: (79000 52%) Loss avg: 0.0216
Hits 91/100 test samples
Duration (Remaining): 56m 18s (- 49m 16s) Iters: (80000 53%) Loss avg: 0.0419
Hits 91/100 test samples
Duration (Remaining): 57m 5s (- 48m 38s) Iters: (81000 54%) Loss avg: 0.0372
Hits 86/100 test samples
Duration (Remaining): 57m 48s (- 47m 56s) Iters: (82000 54%) Loss avg: 0.0196
Hits 89/100 test samples
Duration (Remaining): 58m 26s (- 47m 10s) Iters: (83000 55%) Loss avg: 0.0459
Hits 92/100 test samples
Duration (Remaining): 59m 13s (- 46m 31s) Iters: (84000 56%) Loss avg: 0.0369
Hits 95/100 test samples
Duration (Remaining): 59m 58s (- 45m 51s) Iters: (85000 56%) Loss avg: 0.0204
Hits 93/100 test samples
Duration (Remaining): 60m 46s (- 45m 13s) Iters: (86000 57%) Loss avg: 0.0276
Hits 86/100 test samples
Duration (Remaining): 61m 35s (- 44m 36s) Iters: (87000 57%) Loss avg: 0.0227
Hits 93/100 test samples
Duration (Remaining): 62m 19s (- 43m 54s) Iters: (88000 58%) Loss avg: 0.0301
Hits 88/100 test samples
Duration (Remaining): 63m 19s (- 43m 24s) Iters: (89000 59%) Loss avg: 0.0227
Hits 95/100 test samples
Duration (Remaining): 63m 53s (- 42m 35s) Iters: (90000 60%) Loss avg: 0.0189
Hits 83/100 test samples
Duration (Remaining): 64m 27s (- 41m 47s) Iters: (91000 60%) Loss avg: 0.0244
Hits 92/100 test samples
Duration (Remaining): 65m 1s (- 40m 59s) Iters: (92000 61%) Loss avg: 0.0149
Hits 82/100 test samples
Duration (Remaining): 65m 38s (- 40m 13s) Iters: (93000 62%) Loss avg: 0.0408
Hits 85/100 test samples
Duration (Remaining): 66m 12s (- 39m 26s) Iters: (94000 62%) Loss avg: 0.0282
Hits 83/100 test samples
Duration (Remaining): 66m 47s (- 38m 40s) Iters: (95000 63%) Loss avg: 0.0350
Hits 92/100 test samples
Duration (Remaining): 67m 21s (- 37m 53s) Iters: (96000 64%) Loss avg: 0.0288
Hits 89/100 test samples
Duration (Remaining): 67m 55s (- 37m 6s) Iters: (97000 64%) Loss avg: 0.0223
Hits 87/100 test samples
Duration (Remaining): 68m 31s (- 36m 21s) Iters: (98000 65%) Loss avg: 0.0318
Hits 83/100 test samples
Duration (Remaining): 69m 9s (- 35m 37s) Iters: (99000 66%) Loss avg: 0.0272
Hits 91/100 test samples
Duration (Remaining): 69m 56s (- 34m 58s) Iters: (100000 66%) Loss avg: 0.0214
Hits 97/100 test samples
Duration (Remaining): 70m 39s (- 34m 17s) Iters: (101000 67%) Loss avg: 0.0178
Hits 92/100 test samples
Duration (Remaining): 71m 17s (- 33m 33s) Iters: (102000 68%) Loss avg: 0.0178
Hits 95/100 test samples
Duration (Remaining): 71m 53s (- 32m 48s) Iters: (103000 68%) Loss avg: 0.0336
Hits 88/100 test samples
Duration (Remaining): 72m 30s (- 32m 4s) Iters: (104000 69%) Loss avg: 0.0233
Hits 88/100 test samples
Duration (Remaining): 73m 6s (- 31m 19s) Iters: (105000 70%) Loss avg: 0.0428
Hits 91/100 test samples
Duration (Remaining): 73m 39s (- 30m 34s) Iters: (106000 70%) Loss avg: 0.0204
Hits 95/100 test samples
Duration (Remaining): 74m 12s (- 29m 49s) Iters: (107000 71%) Loss avg: 0.0097
Hits 96/100 test samples
Duration (Remaining): 74m 46s (- 29m 4s) Iters: (108000 72%) Loss avg: 0.0228
Hits 91/100 test samples
Duration (Remaining): 75m 18s (- 28m 19s) Iters: (109000 72%) Loss avg: 0.0189
Hits 93/100 test samples
Duration (Remaining): 75m 52s (- 27m 35s) Iters: (110000 73%) Loss avg: 0.0186
Hits 92/100 test samples
Duration (Remaining): 76m 23s (- 26m 50s) Iters: (111000 74%) Loss avg: 0.0106
Hits 96/100 test samples
Duration (Remaining): 76m 53s (- 26m 5s) Iters: (112000 74%) Loss avg: 0.0141
Hits 95/100 test samples
Duration (Remaining): 77m 23s (- 25m 20s) Iters: (113000 75%) Loss avg: 0.0225
Hits 96/100 test samples
Duration (Remaining): 77m 54s (- 24m 36s) Iters: (114000 76%) Loss avg: 0.0135
Hits 91/100 test samples
Duration (Remaining): 78m 24s (- 23m 51s) Iters: (115000 76%) Loss avg: 0.0142
Hits 93/100 test samples
Duration (Remaining): 78m 55s (- 23m 8s) Iters: (116000 77%) Loss avg: 0.0115
Hits 93/100 test samples
Duration (Remaining): 79m 25s (- 22m 24s) Iters: (117000 78%) Loss avg: 0.0168
Hits 96/100 test samples
Duration (Remaining): 79m 55s (- 21m 40s) Iters: (118000 78%) Loss avg: 0.0102
Hits 100/100 test samples
Duration (Remaining): 80m 26s (- 20m 57s) Iters: (119000 79%) Loss avg: 0.0190
Hits 94/100 test samples
Duration (Remaining): 80m 56s (- 20m 14s) Iters: (120000 80%) Loss avg: 0.0056
Hits 99/100 test samples
Duration (Remaining): 81m 26s (- 19m 31s) Iters: (121000 80%) Loss avg: 0.0085
Hits 98/100 test samples
Duration (Remaining): 81m 56s (- 18m 48s) Iters: (122000 81%) Loss avg: 0.0194
Hits 97/100 test samples
Duration (Remaining): 82m 26s (- 18m 5s) Iters: (123000 82%) Loss avg: 0.0077
Hits 96/100 test samples
Duration (Remaining): 82m 57s (- 17m 23s) Iters: (124000 82%) Loss avg: 0.0080
Hits 93/100 test samples
Duration (Remaining): 83m 26s (- 16m 41s) Iters: (125000 83%) Loss avg: 0.0341
Hits 92/100 test samples
Duration (Remaining): 83m 57s (- 15m 59s) Iters: (126000 84%) Loss avg: 0.0199
Hits 95/100 test samples
Duration (Remaining): 84m 29s (- 15m 18s) Iters: (127000 84%) Loss avg: 0.0134
Hits 95/100 test samples
Duration (Remaining): 84m 59s (- 14m 36s) Iters: (128000 85%) Loss avg: 0.0072
Hits 91/100 test samples
Duration (Remaining): 85m 30s (- 13m 55s) Iters: (129000 86%) Loss avg: 0.0051
Hits 97/100 test samples
Duration (Remaining): 86m 1s (- 13m 14s) Iters: (130000 86%) Loss avg: 0.0183
Hits 93/100 test samples
Duration (Remaining): 86m 32s (- 12m 33s) Iters: (131000 87%) Loss avg: 0.0421
Hits 90/100 test samples
Duration (Remaining): 87m 2s (- 11m 52s) Iters: (132000 88%) Loss avg: 0.0107
Hits 96/100 test samples
Duration (Remaining): 87m 33s (- 11m 11s) Iters: (133000 88%) Loss avg: 0.0762
Hits 98/100 test samples
Duration (Remaining): 88m 3s (- 10m 30s) Iters: (134000 89%) Loss avg: 0.0166
Hits 97/100 test samples
Duration (Remaining): 88m 34s (- 9m 50s) Iters: (135000 90%) Loss avg: 0.0100
Hits 97/100 test samples
Duration (Remaining): 89m 4s (- 9m 10s) Iters: (136000 90%) Loss avg: 0.0138
Hits 93/100 test samples
Duration (Remaining): 89m 35s (- 8m 30s) Iters: (137000 91%) Loss avg: 0.0164
Hits 94/100 test samples
Duration (Remaining): 90m 4s (- 7m 49s) Iters: (138000 92%) Loss avg: 0.0056
Hits 94/100 test samples
Duration (Remaining): 90m 35s (- 7m 10s) Iters: (139000 92%) Loss avg: 0.0222
Hits 95/100 test samples
Duration (Remaining): 91m 6s (- 6m 30s) Iters: (140000 93%) Loss avg: 0.0123
Hits 97/100 test samples
Duration (Remaining): 91m 36s (- 5m 50s) Iters: (141000 94%) Loss avg: 0.0050
Hits 96/100 test samples
Duration (Remaining): 92m 7s (- 5m 11s) Iters: (142000 94%) Loss avg: 0.0040
Hits 99/100 test samples
Duration (Remaining): 92m 38s (- 4m 32s) Iters: (143000 95%) Loss avg: 0.0077
Hits 92/100 test samples
Duration (Remaining): 93m 8s (- 3m 52s) Iters: (144000 96%) Loss avg: 0.0157
Hits 91/100 test samples
Duration (Remaining): 93m 38s (- 3m 13s) Iters: (145000 96%) Loss avg: 0.0041
Hits 100/100 test samples
Duration (Remaining): 94m 9s (- 2m 34s) Iters: (146000 97%) Loss avg: 0.0094
Hits 96/100 test samples
Duration (Remaining): 94m 40s (- 1m 55s) Iters: (147000 98%) Loss avg: 0.0061
Hits 99/100 test samples
Duration (Remaining): 95m 11s (- 1m 17s) Iters: (148000 98%) Loss avg: 0.0032
Hits 98/100 test samples
Duration (Remaining): 95m 44s (- 0m 38s) Iters: (149000 99%) Loss avg: 0.0103
Hits 95/100 test samples
Duration (Remaining): 96m 14s (- 0m 0s) Iters: (150000 100%) Loss avg: 0.0124
Hits 98/100 test samples
Evaluating training split accuracy
Evaluation accuracy: 98/100 = 0.98%
Evaluating test split accuracy
Evaluation accuracy: 0/100 = 0.00%
Saved model at saved/mcd_150000_4.pt
