Reading lines...
Read 20910 sentence pairs
Trimmed to 20910 sentence pairs
Counting words...
Counted words:
scan_in 15
scan_out 8
Training on cuda:2
Initialized model GRU
Training SCAN model GRU on split 'turn_left' for 150000 iterations on device cuda:2, intermediate rep? False, tag None
Reading lines...
Read 21890 sentence pairs
Trimmed to 21890 sentence pairs
Counting words...
Counted words:
scan_in 15
scan_out 8
Loaded data from scan/SCAN-master/turn_left_train.txt
21890 examples. Sample pair: ['jump opposite right thrice and jump left thrice', 'I_TURN_RIGHT I_TURN_RIGHT I_JUMP I_TURN_RIGHT I_TURN_RIGHT I_JUMP I_TURN_RIGHT I_TURN_RIGHT I_JUMP I_TURN_LEFT I_JUMP I_TURN_LEFT I_JUMP I_TURN_LEFT I_JUMP']
Reading lines...
Read 1208 sentence pairs
Trimmed to 1208 sentence pairs
Counting words...
Counted words:
scan_in 15
scan_out 8
Loaded data from scan/SCAN-master/turn_left_test.txt
1208 examples. Sample pair: ['turn left thrice and run thrice', 'I_TURN_LEFT I_TURN_LEFT I_TURN_LEFT I_RUN I_RUN I_RUN']
Starting training: 150000 iterations
Hits 0/100 test samples
Duration (Remaining): 3m 36s (- 538m 46s) Iters: (1000 0%) Loss avg: 1.2524
Hits 13/100 test samples
Duration (Remaining): 6m 6s (- 452m 2s) Iters: (2000 1%) Loss avg: 0.8318
Hits 9/100 test samples
Duration (Remaining): 8m 32s (- 418m 12s) Iters: (3000 2%) Loss avg: 0.6571
Hits 13/100 test samples
Duration (Remaining): 10m 54s (- 398m 22s) Iters: (4000 2%) Loss avg: 0.5823
Hits 17/100 test samples
Duration (Remaining): 13m 15s (- 384m 27s) Iters: (5000 3%) Loss avg: 0.5107
Hits 27/100 test samples
Duration (Remaining): 15m 34s (- 373m 53s) Iters: (6000 4%) Loss avg: 0.4906
Hits 31/100 test samples
Duration (Remaining): 17m 43s (- 361m 59s) Iters: (7000 4%) Loss avg: 0.4195
Hits 25/100 test samples
Duration (Remaining): 19m 45s (- 350m 42s) Iters: (8000 5%) Loss avg: 0.3997
Hits 25/100 test samples
Duration (Remaining): 21m 52s (- 342m 42s) Iters: (9000 6%) Loss avg: 0.3722
Hits 25/100 test samples
Duration (Remaining): 23m 58s (- 335m 33s) Iters: (10000 6%) Loss avg: 0.3423
Hits 21/100 test samples
Duration (Remaining): 26m 0s (- 328m 41s) Iters: (11000 7%) Loss avg: 0.3208
Hits 39/100 test samples
Duration (Remaining): 28m 5s (- 323m 2s) Iters: (12000 8%) Loss avg: 0.3122
Hits 39/100 test samples
Duration (Remaining): 30m 10s (- 317m 58s) Iters: (13000 8%) Loss avg: 0.2868
Hits 44/100 test samples
Duration (Remaining): 32m 13s (- 313m 2s) Iters: (14000 9%) Loss avg: 0.2560
Hits 45/100 test samples
Duration (Remaining): 34m 17s (- 308m 38s) Iters: (15000 10%) Loss avg: 0.2558
Hits 31/100 test samples
Duration (Remaining): 36m 21s (- 304m 32s) Iters: (16000 10%) Loss avg: 0.2416
Hits 51/100 test samples
Duration (Remaining): 38m 26s (- 300m 44s) Iters: (17000 11%) Loss avg: 0.2115
Hits 57/100 test samples
Duration (Remaining): 40m 30s (- 297m 3s) Iters: (18000 12%) Loss avg: 0.2177
Hits 36/100 test samples
Duration (Remaining): 42m 38s (- 294m 2s) Iters: (19000 12%) Loss avg: 0.2118
Hits 52/100 test samples
Duration (Remaining): 44m 49s (- 291m 24s) Iters: (20000 13%) Loss avg: 0.2095
Hits 46/100 test samples
Duration (Remaining): 46m 59s (- 288m 37s) Iters: (21000 14%) Loss avg: 0.1647
Hits 52/100 test samples
Duration (Remaining): 49m 7s (- 285m 51s) Iters: (22000 14%) Loss avg: 0.1588
Hits 43/100 test samples
Duration (Remaining): 51m 16s (- 283m 9s) Iters: (23000 15%) Loss avg: 0.1673
Hits 62/100 test samples
Duration (Remaining): 53m 23s (- 280m 17s) Iters: (24000 16%) Loss avg: 0.1568
Hits 51/100 test samples
Duration (Remaining): 55m 30s (- 277m 30s) Iters: (25000 16%) Loss avg: 0.1422
Hits 60/100 test samples
Duration (Remaining): 57m 38s (- 274m 53s) Iters: (26000 17%) Loss avg: 0.1511
Hits 54/100 test samples
Duration (Remaining): 59m 44s (- 272m 7s) Iters: (27000 18%) Loss avg: 0.1429
Hits 62/100 test samples
Duration (Remaining): 61m 52s (- 269m 36s) Iters: (28000 18%) Loss avg: 0.1322
Hits 61/100 test samples
Duration (Remaining): 63m 57s (- 266m 49s) Iters: (29000 19%) Loss avg: 0.1395
Hits 60/100 test samples
Duration (Remaining): 66m 0s (- 264m 0s) Iters: (30000 20%) Loss avg: 0.1262
Hits 66/100 test samples
Duration (Remaining): 68m 10s (- 261m 40s) Iters: (31000 20%) Loss avg: 0.1166
Hits 61/100 test samples
Duration (Remaining): 70m 15s (- 259m 4s) Iters: (32000 21%) Loss avg: 0.1316
Hits 62/100 test samples
Duration (Remaining): 72m 21s (- 256m 33s) Iters: (33000 22%) Loss avg: 0.1104
Hits 62/100 test samples
Duration (Remaining): 74m 25s (- 253m 54s) Iters: (34000 22%) Loss avg: 0.0999
Hits 71/100 test samples
Duration (Remaining): 76m 31s (- 251m 26s) Iters: (35000 23%) Loss avg: 0.1137
Hits 66/100 test samples
Duration (Remaining): 78m 41s (- 249m 10s) Iters: (36000 24%) Loss avg: 0.0937
Hits 63/100 test samples
Duration (Remaining): 80m 45s (- 246m 38s) Iters: (37000 24%) Loss avg: 0.1025
Hits 79/100 test samples
Duration (Remaining): 82m 50s (- 244m 9s) Iters: (38000 25%) Loss avg: 0.0816
Hits 70/100 test samples
Duration (Remaining): 84m 58s (- 241m 49s) Iters: (39000 26%) Loss avg: 0.0847
Hits 70/100 test samples
Duration (Remaining): 87m 3s (- 239m 23s) Iters: (40000 26%) Loss avg: 0.0991
Hits 69/100 test samples
Duration (Remaining): 89m 11s (- 237m 6s) Iters: (41000 27%) Loss avg: 0.0683
Hits 69/100 test samples
Duration (Remaining): 91m 14s (- 234m 38s) Iters: (42000 28%) Loss avg: 0.0975
Hits 71/100 test samples
Duration (Remaining): 93m 21s (- 232m 17s) Iters: (43000 28%) Loss avg: 0.0807
Hits 84/100 test samples
Duration (Remaining): 95m 26s (- 229m 55s) Iters: (44000 29%) Loss avg: 0.0482
Hits 72/100 test samples
Duration (Remaining): 97m 29s (- 227m 29s) Iters: (45000 30%) Loss avg: 0.0722
Hits 72/100 test samples
Duration (Remaining): 99m 36s (- 225m 11s) Iters: (46000 30%) Loss avg: 0.0720
Hits 79/100 test samples
Duration (Remaining): 101m 43s (- 222m 54s) Iters: (47000 31%) Loss avg: 0.0710
Hits 83/100 test samples
Duration (Remaining): 103m 47s (- 220m 34s) Iters: (48000 32%) Loss avg: 0.0751
Hits 83/100 test samples
Duration (Remaining): 105m 54s (- 218m 17s) Iters: (49000 32%) Loss avg: 0.0506
Hits 91/100 test samples
Duration (Remaining): 108m 7s (- 216m 15s) Iters: (50000 33%) Loss avg: 0.0426
Hits 87/100 test samples
Duration (Remaining): 110m 14s (- 213m 59s) Iters: (51000 34%) Loss avg: 0.0423
Hits 79/100 test samples
Duration (Remaining): 112m 24s (- 211m 50s) Iters: (52000 34%) Loss avg: 0.0484
Hits 92/100 test samples
Duration (Remaining): 114m 35s (- 209m 43s) Iters: (53000 35%) Loss avg: 0.0454
Hits 84/100 test samples
Duration (Remaining): 116m 45s (- 207m 35s) Iters: (54000 36%) Loss avg: 0.0681
Hits 78/100 test samples
Duration (Remaining): 118m 58s (- 205m 29s) Iters: (55000 36%) Loss avg: 0.0440
Hits 90/100 test samples
Duration (Remaining): 121m 12s (- 203m 26s) Iters: (56000 37%) Loss avg: 0.0512
Hits 88/100 test samples
Duration (Remaining): 123m 21s (- 201m 16s) Iters: (57000 38%) Loss avg: 0.0357
Hits 82/100 test samples
Duration (Remaining): 125m 34s (- 199m 10s) Iters: (58000 38%) Loss avg: 0.0467
Hits 86/100 test samples
Duration (Remaining): 127m 45s (- 197m 3s) Iters: (59000 39%) Loss avg: 0.0622
Hits 77/100 test samples
Duration (Remaining): 129m 58s (- 194m 58s) Iters: (60000 40%) Loss avg: 0.0405
Hits 83/100 test samples
Duration (Remaining): 132m 11s (- 192m 52s) Iters: (61000 40%) Loss avg: 0.0382
Hits 84/100 test samples
Duration (Remaining): 134m 23s (- 190m 44s) Iters: (62000 41%) Loss avg: 0.0426
Hits 95/100 test samples
Duration (Remaining): 136m 30s (- 188m 30s) Iters: (63000 42%) Loss avg: 0.0479
Hits 79/100 test samples
Duration (Remaining): 138m 38s (- 186m 18s) Iters: (64000 42%) Loss avg: 0.0394
Hits 93/100 test samples
Duration (Remaining): 140m 49s (- 184m 9s) Iters: (65000 43%) Loss avg: 0.0282
Hits 84/100 test samples
Duration (Remaining): 142m 57s (- 181m 57s) Iters: (66000 44%) Loss avg: 0.0428
Hits 80/100 test samples
Duration (Remaining): 145m 10s (- 179m 50s) Iters: (67000 44%) Loss avg: 0.0350
Hits 96/100 test samples
Duration (Remaining): 147m 21s (- 177m 42s) Iters: (68000 45%) Loss avg: 0.0255
Hits 96/100 test samples
Duration (Remaining): 149m 33s (- 175m 33s) Iters: (69000 46%) Loss avg: 0.0336
Hits 83/100 test samples
Duration (Remaining): 151m 43s (- 173m 24s) Iters: (70000 46%) Loss avg: 0.0391
Hits 95/100 test samples
Duration (Remaining): 153m 55s (- 171m 16s) Iters: (71000 47%) Loss avg: 0.0287
Hits 93/100 test samples
Duration (Remaining): 156m 5s (- 169m 6s) Iters: (72000 48%) Loss avg: 0.0399
Hits 79/100 test samples
Duration (Remaining): 158m 19s (- 166m 59s) Iters: (73000 48%) Loss avg: 0.0390
Hits 92/100 test samples
Duration (Remaining): 160m 30s (- 164m 50s) Iters: (74000 49%) Loss avg: 0.0296
Hits 88/100 test samples
Duration (Remaining): 162m 43s (- 162m 43s) Iters: (75000 50%) Loss avg: 0.0389
Hits 96/100 test samples
Duration (Remaining): 164m 51s (- 160m 31s) Iters: (76000 50%) Loss avg: 0.0173
Hits 81/100 test samples
Duration (Remaining): 167m 3s (- 158m 22s) Iters: (77000 51%) Loss avg: 0.0386
Hits 89/100 test samples
Duration (Remaining): 169m 15s (- 156m 14s) Iters: (78000 52%) Loss avg: 0.0408
Hits 81/100 test samples
Duration (Remaining): 171m 23s (- 154m 1s) Iters: (79000 52%) Loss avg: 0.0327
Hits 95/100 test samples
Duration (Remaining): 173m 33s (- 151m 51s) Iters: (80000 53%) Loss avg: 0.0226
Hits 86/100 test samples
Duration (Remaining): 175m 46s (- 149m 43s) Iters: (81000 54%) Loss avg: 0.0193
Hits 83/100 test samples
Duration (Remaining): 177m 56s (- 147m 33s) Iters: (82000 54%) Loss avg: 0.0319
Hits 89/100 test samples
Duration (Remaining): 180m 5s (- 145m 22s) Iters: (83000 55%) Loss avg: 0.0212
Hits 96/100 test samples
Duration (Remaining): 182m 11s (- 143m 8s) Iters: (84000 56%) Loss avg: 0.0131
Hits 90/100 test samples
Duration (Remaining): 184m 20s (- 140m 58s) Iters: (85000 56%) Loss avg: 0.0330
Hits 94/100 test samples
Duration (Remaining): 186m 28s (- 138m 46s) Iters: (86000 57%) Loss avg: 0.0297
Hits 80/100 test samples
Duration (Remaining): 188m 30s (- 136m 30s) Iters: (87000 57%) Loss avg: 0.0201
Hits 90/100 test samples
Duration (Remaining): 190m 33s (- 134m 15s) Iters: (88000 58%) Loss avg: 0.0203
Hits 96/100 test samples
Duration (Remaining): 192m 38s (- 132m 2s) Iters: (89000 59%) Loss avg: 0.0195
Hits 90/100 test samples
Duration (Remaining): 194m 38s (- 129m 45s) Iters: (90000 60%) Loss avg: 0.0291
Hits 94/100 test samples
Duration (Remaining): 196m 44s (- 127m 33s) Iters: (91000 60%) Loss avg: 0.0194
Hits 96/100 test samples
Duration (Remaining): 198m 48s (- 125m 20s) Iters: (92000 61%) Loss avg: 0.0258
Hits 96/100 test samples
Duration (Remaining): 200m 49s (- 123m 5s) Iters: (93000 62%) Loss avg: 0.0170
Hits 97/100 test samples
Duration (Remaining): 202m 50s (- 120m 50s) Iters: (94000 62%) Loss avg: 0.0277
Hits 89/100 test samples
Duration (Remaining): 204m 54s (- 118m 37s) Iters: (95000 63%) Loss avg: 0.0176
Hits 94/100 test samples
Duration (Remaining): 207m 1s (- 116m 26s) Iters: (96000 64%) Loss avg: 0.0138
Hits 97/100 test samples
Duration (Remaining): 209m 5s (- 114m 14s) Iters: (97000 64%) Loss avg: 0.0535
Hits 87/100 test samples
Duration (Remaining): 211m 19s (- 112m 7s) Iters: (98000 65%) Loss avg: 0.0224
Hits 98/100 test samples
Duration (Remaining): 213m 24s (- 109m 56s) Iters: (99000 66%) Loss avg: 0.0110
Hits 94/100 test samples
Duration (Remaining): 215m 28s (- 107m 44s) Iters: (100000 66%) Loss avg: 0.0086
Hits 96/100 test samples
Duration (Remaining): 217m 29s (- 105m 30s) Iters: (101000 67%) Loss avg: 0.0243
Hits 95/100 test samples
Duration (Remaining): 219m 34s (- 103m 19s) Iters: (102000 68%) Loss avg: 0.0277
Hits 93/100 test samples
Duration (Remaining): 221m 37s (- 101m 8s) Iters: (103000 68%) Loss avg: 0.0198
Hits 90/100 test samples
Duration (Remaining): 223m 41s (- 98m 56s) Iters: (104000 69%) Loss avg: 0.0205
Hits 96/100 test samples
Duration (Remaining): 225m 51s (- 96m 47s) Iters: (105000 70%) Loss avg: 0.0117
Hits 97/100 test samples
Duration (Remaining): 227m 53s (- 94m 35s) Iters: (106000 70%) Loss avg: 0.0140
Hits 99/100 test samples
Duration (Remaining): 229m 57s (- 92m 24s) Iters: (107000 71%) Loss avg: 0.0346
Hits 91/100 test samples
Duration (Remaining): 232m 2s (- 90m 14s) Iters: (108000 72%) Loss avg: 0.0416
Hits 90/100 test samples
Duration (Remaining): 234m 5s (- 88m 3s) Iters: (109000 72%) Loss avg: 0.0159
Hits 93/100 test samples
Duration (Remaining): 235m 28s (- 85m 37s) Iters: (110000 73%) Loss avg: 0.0106
Hits 100/100 test samples
Duration (Remaining): 236m 17s (- 83m 1s) Iters: (111000 74%) Loss avg: 0.0148
Hits 94/100 test samples
Duration (Remaining): 237m 23s (- 80m 32s) Iters: (112000 74%) Loss avg: 0.0207
Hits 89/100 test samples
Duration (Remaining): 238m 13s (- 78m 0s) Iters: (113000 75%) Loss avg: 0.0153
Hits 95/100 test samples
Duration (Remaining): 239m 1s (- 75m 28s) Iters: (114000 76%) Loss avg: 0.0290
Hits 95/100 test samples
Duration (Remaining): 239m 49s (- 72m 59s) Iters: (115000 76%) Loss avg: 0.0131
Hits 98/100 test samples
Duration (Remaining): 240m 34s (- 70m 30s) Iters: (116000 77%) Loss avg: 0.0048
Hits 92/100 test samples
Duration (Remaining): 241m 18s (- 68m 3s) Iters: (117000 78%) Loss avg: 0.0337
Hits 92/100 test samples
Duration (Remaining): 242m 1s (- 65m 37s) Iters: (118000 78%) Loss avg: 0.0154
Hits 99/100 test samples
Duration (Remaining): 242m 44s (- 63m 14s) Iters: (119000 79%) Loss avg: 0.0055
Hits 97/100 test samples
Duration (Remaining): 243m 27s (- 60m 51s) Iters: (120000 80%) Loss avg: 0.0278
Hits 93/100 test samples
Duration (Remaining): 244m 6s (- 58m 30s) Iters: (121000 80%) Loss avg: 0.0443
Hits 94/100 test samples
Duration (Remaining): 244m 48s (- 56m 11s) Iters: (122000 81%) Loss avg: 0.0103
Hits 98/100 test samples
Duration (Remaining): 245m 30s (- 53m 53s) Iters: (123000 82%) Loss avg: 0.0232
Hits 96/100 test samples
Duration (Remaining): 246m 16s (- 51m 38s) Iters: (124000 82%) Loss avg: 0.0093
Hits 97/100 test samples
Duration (Remaining): 247m 5s (- 49m 25s) Iters: (125000 83%) Loss avg: 0.0233
Hits 100/100 test samples
Duration (Remaining): 247m 48s (- 47m 12s) Iters: (126000 84%) Loss avg: 0.0165
Hits 97/100 test samples
Duration (Remaining): 248m 32s (- 45m 0s) Iters: (127000 84%) Loss avg: 0.0075
Hits 92/100 test samples
Duration (Remaining): 249m 15s (- 42m 50s) Iters: (128000 85%) Loss avg: 0.0068
Hits 94/100 test samples
Duration (Remaining): 250m 4s (- 40m 42s) Iters: (129000 86%) Loss avg: 0.0191
Hits 99/100 test samples
Duration (Remaining): 250m 46s (- 38m 34s) Iters: (130000 86%) Loss avg: 0.0045
Hits 100/100 test samples
Duration (Remaining): 251m 24s (- 36m 27s) Iters: (131000 87%) Loss avg: 0.0111
Hits 97/100 test samples
Duration (Remaining): 252m 0s (- 34m 21s) Iters: (132000 88%) Loss avg: 0.0057
Hits 96/100 test samples
Duration (Remaining): 252m 36s (- 32m 17s) Iters: (133000 88%) Loss avg: 0.0039
Hits 99/100 test samples
Duration (Remaining): 253m 12s (- 30m 14s) Iters: (134000 89%) Loss avg: 0.0492
Hits 93/100 test samples
Duration (Remaining): 253m 49s (- 28m 12s) Iters: (135000 90%) Loss avg: 0.0393
Hits 98/100 test samples
Duration (Remaining): 254m 24s (- 26m 11s) Iters: (136000 90%) Loss avg: 0.0137
Hits 96/100 test samples
Duration (Remaining): 255m 6s (- 24m 12s) Iters: (137000 91%) Loss avg: 0.0151
Hits 93/100 test samples
Duration (Remaining): 255m 49s (- 22m 14s) Iters: (138000 92%) Loss avg: 0.0305
Hits 93/100 test samples
Duration (Remaining): 256m 31s (- 20m 18s) Iters: (139000 92%) Loss avg: 0.0111
Hits 94/100 test samples
Duration (Remaining): 257m 15s (- 18m 22s) Iters: (140000 93%) Loss avg: 0.0289
Hits 97/100 test samples
Duration (Remaining): 258m 0s (- 16m 28s) Iters: (141000 94%) Loss avg: 0.0055
Hits 99/100 test samples
Duration (Remaining): 258m 44s (- 14m 34s) Iters: (142000 94%) Loss avg: 0.0162
Hits 94/100 test samples
Duration (Remaining): 259m 20s (- 12m 41s) Iters: (143000 95%) Loss avg: 0.0158
Hits 97/100 test samples
Duration (Remaining): 259m 56s (- 10m 49s) Iters: (144000 96%) Loss avg: 0.0045
Hits 97/100 test samples
Duration (Remaining): 260m 31s (- 8m 59s) Iters: (145000 96%) Loss avg: 0.0142
Hits 92/100 test samples
Duration (Remaining): 261m 7s (- 7m 9s) Iters: (146000 97%) Loss avg: 0.0168
Hits 99/100 test samples
Duration (Remaining): 261m 41s (- 5m 20s) Iters: (147000 98%) Loss avg: 0.0083
Hits 100/100 test samples
Duration (Remaining): 262m 17s (- 3m 32s) Iters: (148000 98%) Loss avg: 0.0096
Hits 96/100 test samples
Duration (Remaining): 262m 52s (- 1m 45s) Iters: (149000 99%) Loss avg: 0.0456
Hits 84/100 test samples
Duration (Remaining): 263m 26s (- 0m 0s) Iters: (150000 100%) Loss avg: 0.0654
Hits 80/100 test samples
Evaluating training split accuracy
Evaluation accuracy: 18550/21890 = 0.85%
Evaluating test split accuracy
Evaluation accuracy: 775/1208 = 0.64%
Saved model at saved/turn_left_150000.pt
